    <!-- Yeh Naya aur Bilkul Theek Kiya Hua Script Block Hai -->
    <script>
        // --- UI ELEMENTS ---
        const mainInterface = document.querySelector('.main-interface');
        const screenshotUpload = document.getElementById('screenshotUpload');
        const timeframeSelect = document.getElementById('timeframeSelect');
        const getSignalBtn = document.getElementById('getSignalBtn');
        const hackingSound = document.getElementById('hackingSound');
        const lineUpload = document.getElementById('line-upload-to-core');
        const lineTime = document.getElementById('line-time-to-core');
        const lineExecute = document.getElementById('line-core-to-execute');
        
        let isImageReady = false;
        let isTimeSelected = false;

        // --- UI AND ANIMATION FUNCTIONS ---
        function setLineLength(line) {
            const length = line.getTotalLength();
            line.style.strokeDasharray = length;
            line.style.strokeDashoffset = length;
        }

        function updateConnectorLines() {
            const getCoords = (el, side = 'center') => {
                const elRect = el.getBoundingClientRect();
                const containerRect = mainInterface.getBoundingClientRect();
                const x = elRect.left - containerRect.left + elRect.width / 2;
                let y;
                if (side === 'top') y = elRect.top - containerRect.top;
                else if (side === 'bottom') y = elRect.top - containerRect.top + elRect.height;
                else y = elRect.top - containerRect.top + elRect.height / 2;
                return { x, y };
            };
            
            const uploadPoint = getCoords(document.getElementById('upload-panel'), 'bottom');
            const timePoint = getCoords(document.getElementById('timeframe-panel'), 'bottom');
            const coreTopPoint = getCoords(document.getElementById('ai-core-panel'), 'top');
            const coreBottomPoint = getCoords(document.getElementById('ai-core-panel'), 'bottom');
            const executePoint = getCoords(getSignalBtn, 'top');
            
            lineUpload.setAttribute('d', `M ${uploadPoint.x},${uploadPoint.y} V ${coreTopPoint.y}`);
            lineTime.setAttribute('d', `M ${timePoint.x},${timePoint.y} V ${coreTopPoint.y}`);
            lineExecute.setAttribute('d', `M ${coreBottomPoint.x},${coreBottomPoint.y} V ${executePoint.y}`);
            
            [lineUpload, lineTime, lineExecute].forEach(setLineLength);
        }

        window.addEventListener('DOMContentLoaded', updateConnectorLines);
        window.addEventListener('resize', updateConnectorLines);
        
        function resetLines() {
            lineUpload.classList.remove('line-active');
            lineTime.classList.remove('line-active');
            lineExecute.classList.remove('line-active');
        }

        function checkFormCompletion() {
            getSignalBtn.disabled = !(isImageReady && isTimeSelected);
            lineExecute.classList.toggle('line-active', isImageReady && isTimeSelected);
        }

        screenshotUpload.addEventListener('change', (event) => {
            resetLines();
            const file = event.target.files[0];
            isImageReady = !!file;
            if (isImageReady) lineUpload.classList.add('line-active');
            timeframeSelect.value = "";
            isTimeSelected = false;
            if (!file) { checkFormCompletion(); return; }
            
            const reader = new FileReader();
            reader.onload = (e) => {
                const img = new Image(); img.onload = () => { checkFormCompletion(); }; img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        });

        timeframeSelect.addEventListener('change', () => {
            isTimeSelected = !!timeframeSelect.value;
            lineTime.classList.toggle('line-active', isTimeSelected);
            checkFormCompletion();
        });

        getSignalBtn.addEventListener('click', async () => {
            getSignalBtn.disabled = true;
            mainInterface.classList.add('analyzing');
            document.getElementById('analysis-status').textContent = "CONTACTING AI CORE...";
            hackingSound.play();

            const signal = await getOpenAISignal();

            mainInterface.classList.remove('analyzing');
            document.getElementById('analysis-status').textContent = "";
            hackingSound.pause();
            hackingSound.currentTime = 0;
            
            displaySignal(signal);
            checkFormCompletion();
        });
        
        function displaySignal(type) {
            resetLines();
            const resultPanel = document.getElementById('result-panel');
            const timeframeText = `${timeframeSelect.value} Min`;
            let message = '', bgColor = 'var(--panel-bg)', textColor = 'var(--text-color)';
            switch(type) {
                case 'UP':
                    message = `SIGNAL: UP ▲ | ${timeframeText}`;
                    bgColor = 'var(--success-color)'; textColor = '#fff'; break;
                case 'DOWN':
                    message = `SIGNAL: DOWN ▼ | ${timeframeText}`;
                    bgColor = 'var(--danger-color)'; textColor = '#fff'; break;
                case 'HOLD':
                default:
                    message = 'MARKET STABLE | HOLD';
                    bgColor = 'var(--yellow-color)'; textColor = '#0d0c1d'; break;
            }
            resultPanel.textContent = message;
            resultPanel.style.backgroundColor = bgColor;
            resultPanel.style.color = textColor;
        }

        async function getOpenAISignal() {
            // !!! AAPKO APNI NAYI WALI KEY YAHAN DAALNI HAI !!!
            const apiKey = "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";
            
            // Yeh if condition sirf check karne ke liye hai, key yahan nahi likhni
            if (apiKey === "YOUR_NEW_API_KEY_HERE") {
                console.error("OpenAI API Key is not set.");
                alert("ERROR: OpenAI API Key script mein nahi daali gayi.");
                return "HOLD";
            }
            
            const apiURL = 'https://api.openai.com/v1/chat/completions';

            const prompt = `Analyze the current market sentiment for a generic currency pair for a ${timeframeSelect.value} minute binary options trade. Consider common technical indicators like RSI, MACD, and moving averages. Based on this hypothetical analysis, what is the most likely direction?`;

            const requestBody = {
                model: "gpt-3.5-turbo",
                messages: [
                    {
                        "role": "system",
                        "content": "You are a professional trading analyst. Your task is to predict the market direction. You must only respond with one of three words: UP, DOWN, or HOLD. Do not provide any explanation, extra text, or punctuation."
                    },
                    {
                        "role": "user",
                        "content": prompt
                    }
                ],
                temperature: 0.5,
                max_tokens: 3
            };

            try {
                const response = await fetch(apiURL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${apiKey}`
                    },
                    body: JSON.stringify(requestBody)
                });

                if (!response.ok) {
                    console.error("OpenAI API Error:", response.status, response.statusText);
                    const errorData = await response.json();
                    if(errorData.error && errorData.error.message.includes("You exceeded your current quota")){
                        alert("ERROR: Aapke OpenAI account ke credits khatam ho gaye hain. Please check your billing details.");
                    } else {
                        alert("ERROR: OpenAI se error mila. Details console mein check karein.");
                    }
                    return "HOLD";
                }

                const data = await response.json();
                let signal = data.choices[0].message.content.trim().toUpperCase();

                if (['UP', 'DOWN', 'HOLD'].includes(signal)) {
                    return signal;
                } else {
                    return "HOLD";
                }

            } catch (error) {
                console.error("Error calling OpenAI API:", error);
                return "HOLD";
            }
        }
    </script>
